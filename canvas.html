<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>
	<style type="text/css">
		body { margin: 0 }
		canvas { outline: 1q solid black }
	</style>
</head>
<body onload="draw();">
	<canvas id="canvas"></canvas>

	<script>
		function draw() {
			const canvas = document.querySelector('#canvas')

			function setCanvas(width) {
				const apWidth = Math.floor(width / 10) * 10
				canvas.height = apWidth
				canvas.width = apWidth
				return apWidth
			}

			function drawFrame(width) {
				if (canvas.getContext) {
				const ctx = canvas.getContext('2d')

				ctx.strokeRect(10, 10, width - 20, 80)
				ctx.fillText(`Width: ${width}`, 10, 120)
				let i = 0
				while (i < 10) {
					ctx.fillRect(i*20 + 10, 10 + 20 * (i % 4), 20, 20)
					i += 1
				}
				}
			}

			let prevWidth = window.innerWidth
			drawFrame(setCanvas(prevWidth))
			
			window.addEventListener('resize', () => {
				const width = window.innerWidth
				if (Math.abs(prevWidth - width) >= 10) {
					prevWidth = width
					requestAnimationFrame(() => drawFrame(setCanvas(width)))
				}
			})
		}
	</script>
</body>
</html>